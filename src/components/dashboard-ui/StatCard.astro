---
/**
 * StatCard - Display key metrics with trend indicators
 *
 * @description
 * A card component for displaying statistics with optional trend
 * indicators and icons. Commonly used on dashboard overview pages.
 *
 * Features:
 * - Large value display
 * - Optional trend indicator with color coding
 * - Optional icon
 * - Optional description text
 * - Responsive sizing
 *
 * @example
 * ```astro
 * <StatCard
 *   title="Total Users"
 *   value="1,234"
 *   trend={{ value: 12, direction: 'up' }}
 *   icon="users"
 *   description="Active users this month"
 * />
 * ```
 */

import { Icon } from 'astro-icon/components';

interface Props {
  title: string;
  value: string | number;
  trend?: {
    value: number; // Percentage
    direction: 'up' | 'down';
  };
  icon?: string; // Icon name from lucide
  description?: string;
}

const { title, value, trend, icon, description } = Astro.props;
---

<div class="stat-card">
  <div class="stat-card-header">
    <h3 class="stat-card-title">{title}</h3>
    {
      icon && (
        <div class="stat-card-icon">
          <Icon name={`lucide:${icon}`} />
        </div>
      )
    }
  </div>

  <div class="stat-card-body">
    <div class="stat-card-value">{value}</div>

    {
      trend && (
        <div class:list={['stat-card-trend', `stat-card-trend-${trend.direction}`]}>
          <Icon
            name={trend.direction === 'up' ? 'lucide:trending-up' : 'lucide:trending-down'}
            class="stat-card-trend-icon"
          />
          <span class="stat-card-trend-value">
            {trend.value > 0 ? '+' : ''}
            {trend.value}%
          </span>
        </div>
      )
    }
  </div>

  {description && <p class="stat-card-description">{description}</p>}
</div>

<style>
  .stat-card {
    background: var(--color-surface, #fff);
    border: 1px solid var(--color-border, #e5e7eb);
    border-radius: var(--radius-lg, 0.75rem);
    padding: 1.5rem;
    transition: box-shadow 150ms ease;
  }

  .stat-card:hover {
    box-shadow:
      0 4px 6px -1px rgb(0 0 0 / 0.1),
      0 2px 4px -2px rgb(0 0 0 / 0.1);
  }

  .stat-card-header {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    margin-bottom: 1rem;
  }

  .stat-card-title {
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--color-text-muted, #6b7280);
    margin: 0;
  }

  .stat-card-icon {
    width: 2.5rem;
    height: 2.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--color-background, #f9fafb);
    border-radius: var(--radius-md, 0.5rem);
    color: var(--color-primary, #6366f1);
    flex-shrink: 0;
  }

  .stat-card-icon :global(svg) {
    width: 1.5rem;
    height: 1.5rem;
  }

  .stat-card-body {
    display: flex;
    align-items: baseline;
    gap: 0.75rem;
    margin-bottom: 0.5rem;
  }

  .stat-card-value {
    font-size: 2rem;
    font-weight: 700;
    color: var(--color-text, #000);
    line-height: 1;
  }

  .stat-card-trend {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    font-size: 0.875rem;
    font-weight: 600;
    padding: 0.25rem 0.5rem;
    border-radius: var(--radius-sm, 0.375rem);
  }

  .stat-card-trend-up {
    color: var(--color-success, #10b981);
    background: color-mix(in srgb, var(--color-success, #10b981) 10%, transparent);
  }

  .stat-card-trend-down {
    color: var(--color-error, #ef4444);
    background: color-mix(in srgb, var(--color-error, #ef4444) 10%, transparent);
  }

  .stat-card-trend-icon {
    width: 1rem;
    height: 1rem;
  }

  .stat-card-trend-value {
    line-height: 1;
  }

  .stat-card-description {
    font-size: 0.875rem;
    color: var(--color-text-muted, #6b7280);
    margin: 0;
  }

  /* Responsive sizing */
  @media (max-width: 640px) {
    .stat-card {
      padding: 1.25rem;
    }

    .stat-card-value {
      font-size: 1.75rem;
    }

    .stat-card-icon {
      width: 2rem;
      height: 2rem;
    }

    .stat-card-icon :global(svg) {
      width: 1.25rem;
      height: 1.25rem;
    }
  }

  /* Dark mode support */
  @media (prefers-color-scheme: dark) {
    .stat-card {
      background: var(--color-surface, #1f2937);
      border-color: var(--color-border, #374151);
    }

    .stat-card-icon {
      background: var(--color-background, #111827);
    }
  }

  /* Respect reduced motion preference */
  @media (prefers-reduced-motion: reduce) {
    .stat-card {
      transition: none;
    }
  }

  /* Focus visible styles for accessibility */
  .stat-card:focus-visible {
    outline: 2px solid var(--color-primary, #6366f1);
    outline-offset: 2px;
  }
</style>
