---
import MarketingLayout from '@/layouts/MarketingLayout.astro';
import PageHeader from '@sections/content/PageHeader.astro';
import ChangelogList from '@sections/product/ChangelogList.astro';
import { getCollection, type CollectionEntry } from 'astro:content';
import { siteConfig } from '@/config';

type ChangelogEntry = CollectionEntry<'changelog'>;

const changelog = await getCollection(
  'changelog',
  ({ data }: { data: ChangelogEntry['data'] }) => !data.draft
);
const sortedChangelog = changelog.sort(
  (a: ChangelogEntry, b: ChangelogEntry) => b.data.date.getTime() - a.data.date.getTime()
);
---

<MarketingLayout
  title={`Changelog - ${siteConfig.name}`}
  description={`See what's new in ${siteConfig.name}. Track our latest features, improvements, and bug fixes.`}
>
  <PageHeader
    title="Changelog"
    subtitle={`Stay up to date with the latest features, improvements, and fixes in ${siteConfig.name}.`}
  />

  <ChangelogList
    entries={sortedChangelog}
    emptyMessage="No changelog entries yet. Check back soon!"
    background="default"
  />
</MarketingLayout>
