---
import { getCollection, type CollectionEntry } from 'astro:content';
import MarketingLayout from '@/layouts/MarketingLayout.astro';
import Hero from '@sections/marketing/Hero.astro';
import LogoCloud from '@sections/marketing/LogoCloud.astro';
import HowItWorks from '@sections/marketing/HowItWorks.astro';
import FeaturesSection from '@sections/marketing/FeaturesSection.astro';
import BentoGrid from '@sections/marketing/BentoGrid.astro';
import PricingTable from '@sections/pricing/PricingTable.astro';
import TestimonialsSection from '@sections/social-proof/TestimonialsSection.astro';
import CTA from '@sections/marketing/CTA.astro';
import Newsletter from '@sections/marketing/Newsletter.astro';
import { siteConfig } from '@/config';
import IntegrationsGrid from '@sections/marketing/IntegrationsGrid.astro';

type TestimonialEntry = CollectionEntry<'testimonials'>;

const testimonials = await getCollection(
  'testimonials',
  ({ data }: { data: TestimonialEntry['data'] }) => !data.draft
);
const sortedTestimonials = [...testimonials].sort(
  (a: TestimonialEntry, b: TestimonialEntry) => a.data.order - b.data.order
);

const integrations = [
  {
    name: 'LinkedIn',
    logo: '/images/integrations/github.svg',
    category: 'Professional Network',
    featured: true,
    description: 'Analyze interviewer profiles from LinkedIn.',
    href: '/interview-prep',
  },
  {
    name: 'AI-Powered',
    logo: '/images/integrations/slack.svg',
    category: 'Technology',
    featured: true,
    description: 'Advanced AI generates personalized interview questions.',
    href: '/interview-prep',
  },
  {
    name: 'Learning Resources',
    logo: '/images/integrations/n8n.svg',
    category: 'Education',
    featured: true,
    description: 'Curated resources to help you prepare effectively.',
    href: '/interview-prep',
  },
];

const featuredIntegrations = integrations.filter((i) => i.featured);

const bentoItems = [
  {
    title: 'Interviewer Insights',
    description:
      'Deep analysis of your interviewer\'s professional background, expertise areas, and career trajectory.',
    icon: 'lucide:user-check',
    size: 'large' as const,
    accent: 'primary' as const,
    href: '/interview-prep',
  },
  {
    title: 'Custom Questions',
    description: 'Tailored interview questions based on role and interviewer.',
    icon: 'lucide:message-square',
    accent: 'blue' as const,
    href: '/interview-prep',
  },
  {
    title: 'Learning Paths',
    description: 'Curated resources to master each topic effectively.',
    icon: 'lucide:graduation-cap',
    accent: 'green' as const,
    href: '/interview-prep',
  },
  {
    title: 'Preparation Strategy',
    description:
      'Comprehensive preparation plan with question depth analysis and expected answer frameworks.',
    icon: 'lucide:clipboard-check',
    size: 'medium' as const,
    accent: 'purple' as const,
    href: '/interview-prep',
  },
];

const features = [
  {
    icon: 'lucide:user-search',
    title: 'LinkedIn Profile Analysis',
    description:
      'Our AI analyzes your interviewer\'s LinkedIn profile to understand their background, expertise, and professional focus areas.',
  },
  {
    icon: 'lucide:brain',
    title: 'AI-Generated Questions',
    description:
      'Get personalized interview questions tailored to both the interviewer\'s expertise and your target role.',
  },
  {
    icon: 'lucide:book-open',
    title: 'Learning Resources',
    description:
      'Access curated learning materials and resources to help you prepare for each question effectively.',
  },
  {
    icon: 'lucide:target',
    title: 'Role-Specific Preparation',
    description:
      'Questions are customized based on your target position, skills, and experience level for maximum relevance.',
  },
  {
    icon: 'lucide:layers',
    title: 'Question Depth Analysis',
    description:
      'Understand the expected depth of each answer with detailed explanations and context.',
  },
  {
    icon: 'lucide:zap',
    title: 'Fast & Efficient',
    description:
      'Get your personalized interview preparation materials in minutes, not hours of manual research.',
  },
];

const pricingPlans = [
  {
    name: 'Free',
    monthlyPrice: 0,
    description: 'Perfect for trying out the platform',
    features: ['5 interview preparations', 'Basic LinkedIn analysis', 'Standard questions', 'Email support'],
    cta: { label: 'Get Started', href: '/interview-prep' },
  },
  {
    name: 'Pro',
    monthlyPrice: 15,
    description: 'For serious job seekers',
    features: [
      'Unlimited preparations',
      'Deep LinkedIn analysis',
      'Advanced AI questions',
      'Priority support',
    ],
    highlighted: true,
    cta: { label: 'Start Free Trial', href: '/register' },
  },
  {
    name: 'Enterprise',
    monthlyPrice: null,
    customPrice: 'Custom',
    description: 'For organizations and teams',
    features: ['Everything in Pro', 'Team accounts', 'Custom integrations', 'Dedicated support'],
    cta: { label: 'Contact Sales', href: '/contact' },
  },
];
---

<MarketingLayout
  title={`${siteConfig.name} - ${siteConfig.description}`}
  description={siteConfig.description}
>
  <Hero
    title="Ace Your Next Interview with AI-Powered Preparation"
    subtitle="Get personalized interview questions tailored to your interviewer's background and your target role. Analyze LinkedIn profiles, receive custom questions, and access curated learning resources to prepare effectively."
    primaryCTA={{ label: 'Start Preparing', href: '/interview-prep' }}
    secondaryCTA={{ label: 'Learn More', href: '#how-it-works' }}
  />

  <LogoCloud
    title="Trusted by job seekers and career professionals"
    logos={[
      { name: 'Logo Ipsum 1', src: '/images/logos/logoipsum-1.svg' },
      { name: 'Logo Ipsum 2', src: '/images/logos/logoipsum-2.svg' },
      { name: 'Logo Ipsum 3', src: '/images/logos/logoipsum-3.svg' },
      { name: 'Logo Ipsum 4', src: '/images/logos/logoipsum-4.svg' },
      { name: 'Logo Ipsum 5', src: '/images/logos/logoipsum-5.svg' },
      { name: 'Logo Ipsum 6', src: '/images/logos/logoipsum-6.svg' },
    ]}
    grayscale={false}
    logoSize="lg"
  />

  <HowItWorks
    title="Prepare in 3 simple steps"
    subtitle="From LinkedIn profile to personalized interview questions in minutes."
    steps={[
      {
        title: 'Enter LinkedIn Profile',
        description:
          "Provide your interviewer's LinkedIn URL. Our AI analyzes their background, expertise, and professional experience.",
        icon: 'lucide:user-search',
      },
      {
        title: 'Share Your Details',
        description:
          'Tell us about your target position, skills, and experience level to get tailored questions.',
        icon: 'lucide:file-text',
      },
      {
        title: 'Get Personalized Questions',
        description: 'Receive custom interview questions with explanations, expected depth, and learning resources.',
        icon: 'lucide:brain',
      },
    ]}
    variant="horizontal"
    background="muted"
  />

  <IntegrationsGrid
    title="Key Features"
    subtitle="Everything you need to prepare for your interview with confidence."
    integrations={featuredIntegrations}
    variant="detailed"
    invertOnDark={false}
    columns={3}
    background="default"
    footerLink={{ label: 'Start preparing now →', href: '/interview-prep' }}
  />

  <FeaturesSection
    title="Everything you need to ace your interview"
    subtitle="From profile analysis to personalized questions, our platform provides all the tools you need to prepare with confidence."
    features={features}
    background="muted"
    footerLink={{ label: 'Start your preparation →', href: '/interview-prep' }}
  />

  <BentoGrid
    title="Comprehensive Interview Preparation"
    subtitle="Everything you need to understand your interviewer and prepare effectively for your interview."
    items={bentoItems}
    background="muted"
  />

  <PricingTable
    title="Simple, transparent pricing"
    subtitle="Start free and upgrade as you need. No hidden fees."
    plans={pricingPlans}
    annualDiscount={20}
    background="default"
    footerLink={{ label: 'View full pricing details →', href: '/pricing' }}
  />

  {
    siteConfig.features.testimonials && sortedTestimonials.length > 0 && (
      <TestimonialsSection
        title="Success stories from job seekers"
        subtitle="Join thousands of candidates who used our platform to prepare and succeed in their interviews."
        background="muted"
        limit={4}
        footerLink={{ label: 'View all testimonials →', href: '/testimonials' }}
        testimonials={sortedTestimonials.map((t) => ({
          quote: t.data.quote,
          author: t.data.author,
          role: t.data.role,
          company: t.data.company,
          avatar: t.data.avatar,
        }))}
      />
    )
  }

  <CTA
    title="Ready to ace your next interview?"
    description="Get started with personalized interview preparation today. Analyze your interviewer's profile and receive custom questions in minutes."
    action={{ label: 'Start Preparing Now', href: '/interview-prep' }}
  />

  <Newsletter />
</MarketingLayout>
